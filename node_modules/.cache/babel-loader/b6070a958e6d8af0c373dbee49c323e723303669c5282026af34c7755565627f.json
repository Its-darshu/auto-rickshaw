{"ast":null,"code":"import React,{useState}from'react';import{useParams,Link}from'react-router-dom';import{ArrowLeft,MapPin,Users}from'lucide-react';import{useLanguage}from'../context/LanguageContext';import{useData}from'../context/DataContext';import DriverCard from'../components/DriverCard';import SearchBar from'../components/SearchBar';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StagePage=()=>{const{stageId}=useParams();const{t,language}=useLanguage();const{stages,getDriversByStage,searchDrivers}=useData();const[filteredDrivers,setFilteredDrivers]=useState([]);const[isSearching,setIsSearching]=useState(false);const stage=stages.find(s=>s.id===stageId);const allDrivers=stageId?getDriversByStage(stageId):[];const stageName=stage?language==='kn'?stage.nameKn:stage.name:'';const handleSearch=query=>{if(query.trim()){setIsSearching(true);// Search within this stage's drivers\nconst results=allDrivers.filter(driver=>driver.name.toLowerCase().includes(query.toLowerCase())||driver.phoneNumber.includes(query)||driver.vehicleNumber.toLowerCase().includes(query.toLowerCase()));setFilteredDrivers(results);}else{setIsSearching(false);setFilteredDrivers([]);}};if(!stage){return/*#__PURE__*/_jsx(\"div\",{className:\"stage-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Stage not found\"}),/*#__PURE__*/_jsxs(Link,{to:\"/\",className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(ArrowLeft,{size:18}),\"Go Home\"]})]})})});}const driversToShow=isSearching?filteredDrivers:allDrivers;const emergencyDrivers=driversToShow.filter(d=>d.isEmergency);const regularDrivers=driversToShow.filter(d=>!d.isEmergency);return/*#__PURE__*/_jsxs(\"div\",{className:\"stage-page\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"stage-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"back-btn\",children:/*#__PURE__*/_jsx(ArrowLeft,{size:20})}),/*#__PURE__*/_jsxs(\"div\",{className:\"stage-title\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stage-icon\",children:/*#__PURE__*/_jsx(MapPin,{size:28})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:stageName}),/*#__PURE__*/_jsxs(\"div\",{className:\"stage-stats\",children:[/*#__PURE__*/_jsx(Users,{size:16}),/*#__PURE__*/_jsxs(\"span\",{children:[allDrivers.length,\" \",t('availableNow')]})]})]})]})]})}),/*#__PURE__*/_jsx(\"main\",{className:\"main-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(SearchBar,{onSearch:handleSearch,placeholder:\"Search drivers in \".concat(stageName,\"...\")}),emergencyDrivers.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"emergency-drivers-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"section-title emergency\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"emergency-badge\",children:t('emergency')}),\"Emergency Drivers\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"drivers-grid\",children:emergencyDrivers.map(driver=>/*#__PURE__*/_jsx(DriverCard,{driver:driver,stage:stage},driver.id))})]}),regularDrivers.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"regular-drivers-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"section-title\",children:[\"Available Drivers\",emergencyDrivers.length>0&&\" (\".concat(regularDrivers.length,\")\")]}),/*#__PURE__*/_jsx(\"div\",{className:\"drivers-grid\",children:regularDrivers.map(driver=>/*#__PURE__*/_jsx(DriverCard,{driver:driver,stage:stage},driver.id))})]}),driversToShow.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"no-drivers\",children:isSearching?/*#__PURE__*/_jsx(\"p\",{children:t('noDriversFound')}):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(Users,{size:48}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"No drivers available in \",stageName]}),/*#__PURE__*/_jsx(\"p\",{children:\"Please try another stage or check back later.\"}),/*#__PURE__*/_jsxs(Link,{to:\"/\",className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(ArrowLeft,{size:18}),\"Back to Home\"]})]})})]})})]});};export default StagePage;","map":{"version":3,"names":["React","useState","useParams","Link","ArrowLeft","MapPin","Users","useLanguage","useData","DriverCard","SearchBar","jsx","_jsx","jsxs","_jsxs","StagePage","stageId","t","language","stages","getDriversByStage","searchDrivers","filteredDrivers","setFilteredDrivers","isSearching","setIsSearching","stage","find","s","id","allDrivers","stageName","nameKn","name","handleSearch","query","trim","results","filter","driver","toLowerCase","includes","phoneNumber","vehicleNumber","className","children","to","size","driversToShow","emergencyDrivers","d","isEmergency","regularDrivers","length","onSearch","placeholder","concat","map"],"sources":["D:/proj/auto-rickshaw/src/pages/StagePage.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport { ArrowLeft, MapPin, Users } from 'lucide-react';\r\nimport { useLanguage } from '../context/LanguageContext';\r\nimport { useData } from '../context/DataContext';\r\nimport DriverCard from '../components/DriverCard';\r\nimport SearchBar from '../components/SearchBar';\r\n\r\nconst StagePage: React.FC = () => {\r\n  const { stageId } = useParams<{ stageId: string }>();\r\n  const { t, language } = useLanguage();\r\n  const { stages, getDriversByStage, searchDrivers } = useData();\r\n  const [filteredDrivers, setFilteredDrivers] = useState<any[]>([]);\r\n  const [isSearching, setIsSearching] = useState(false);\r\n\r\n  const stage = stages.find(s => s.id === stageId);\r\n  const allDrivers = stageId ? getDriversByStage(stageId) : [];\r\n  const stageName = stage ? (language === 'kn' ? stage.nameKn : stage.name) : '';\r\n\r\n  const handleSearch = (query: string) => {\r\n    if (query.trim()) {\r\n      setIsSearching(true);\r\n      // Search within this stage's drivers\r\n      const results = allDrivers.filter(driver =>\r\n        driver.name.toLowerCase().includes(query.toLowerCase()) ||\r\n        driver.phoneNumber.includes(query) ||\r\n        driver.vehicleNumber.toLowerCase().includes(query.toLowerCase())\r\n      );\r\n      setFilteredDrivers(results);\r\n    } else {\r\n      setIsSearching(false);\r\n      setFilteredDrivers([]);\r\n    }\r\n  };\r\n\r\n  if (!stage) {\r\n    return (\r\n      <div className=\"stage-page\">\r\n        <div className=\"container\">\r\n          <div className=\"error-message\">\r\n            <h2>Stage not found</h2>\r\n            <Link to=\"/\" className=\"btn btn-primary\">\r\n              <ArrowLeft size={18} />\r\n              Go Home\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const driversToShow = isSearching ? filteredDrivers : allDrivers;\r\n  const emergencyDrivers = driversToShow.filter(d => d.isEmergency);\r\n  const regularDrivers = driversToShow.filter(d => !d.isEmergency);\r\n\r\n  return (\r\n    <div className=\"stage-page\">\r\n      <header className=\"stage-header\">\r\n        <div className=\"container\">\r\n          <Link to=\"/\" className=\"back-btn\">\r\n            <ArrowLeft size={20} />\r\n          </Link>\r\n          \r\n          <div className=\"stage-title\">\r\n            <div className=\"stage-icon\">\r\n              <MapPin size={28} />\r\n            </div>\r\n            <div>\r\n              <h1>{stageName}</h1>\r\n              <div className=\"stage-stats\">\r\n                <Users size={16} />\r\n                <span>{allDrivers.length} {t('availableNow')}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"main-content\">\r\n        <div className=\"container\">\r\n          {/* Search within stage */}\r\n          <SearchBar \r\n            onSearch={handleSearch} \r\n            placeholder={`Search drivers in ${stageName}...`}\r\n          />\r\n\r\n          {/* Emergency Drivers */}\r\n          {emergencyDrivers.length > 0 && (\r\n            <section className=\"emergency-drivers-section\">\r\n              <h2 className=\"section-title emergency\">\r\n                <span className=\"emergency-badge\">{t('emergency')}</span>\r\n                Emergency Drivers\r\n              </h2>\r\n              <div className=\"drivers-grid\">\r\n                {emergencyDrivers.map((driver) => (\r\n                  <DriverCard key={driver.id} driver={driver} stage={stage} />\r\n                ))}\r\n              </div>\r\n            </section>\r\n          )}\r\n\r\n          {/* Regular Drivers */}\r\n          {regularDrivers.length > 0 && (\r\n            <section className=\"regular-drivers-section\">\r\n              <h2 className=\"section-title\">\r\n                Available Drivers\r\n                {emergencyDrivers.length > 0 && ` (${regularDrivers.length})`}\r\n              </h2>\r\n              <div className=\"drivers-grid\">\r\n                {regularDrivers.map((driver) => (\r\n                  <DriverCard key={driver.id} driver={driver} stage={stage} />\r\n                ))}\r\n              </div>\r\n            </section>\r\n          )}\r\n\r\n          {/* No drivers found */}\r\n          {driversToShow.length === 0 && (\r\n            <div className=\"no-drivers\">\r\n              {isSearching ? (\r\n                <p>{t('noDriversFound')}</p>\r\n              ) : (\r\n                <div className=\"empty-state\">\r\n                  <Users size={48} />\r\n                  <h3>No drivers available in {stageName}</h3>\r\n                  <p>Please try another stage or check back later.</p>\r\n                  <Link to=\"/\" className=\"btn btn-primary\">\r\n                    <ArrowLeft size={18} />\r\n                    Back to Home\r\n                  </Link>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StagePage;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,SAAS,CAAEC,IAAI,KAAQ,kBAAkB,CAClD,OAASC,SAAS,CAAEC,MAAM,CAAEC,KAAK,KAAQ,cAAc,CACvD,OAASC,WAAW,KAAQ,4BAA4B,CACxD,OAASC,OAAO,KAAQ,wBAAwB,CAChD,MAAO,CAAAC,UAAU,KAAM,0BAA0B,CACjD,MAAO,CAAAC,SAAS,KAAM,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEhD,KAAM,CAAAC,SAAmB,CAAGA,CAAA,GAAM,CAChC,KAAM,CAAEC,OAAQ,CAAC,CAAGd,SAAS,CAAsB,CAAC,CACpD,KAAM,CAAEe,CAAC,CAAEC,QAAS,CAAC,CAAGX,WAAW,CAAC,CAAC,CACrC,KAAM,CAAEY,MAAM,CAAEC,iBAAiB,CAAEC,aAAc,CAAC,CAAGb,OAAO,CAAC,CAAC,CAC9D,KAAM,CAACc,eAAe,CAAEC,kBAAkB,CAAC,CAAGtB,QAAQ,CAAQ,EAAE,CAAC,CACjE,KAAM,CAACuB,WAAW,CAAEC,cAAc,CAAC,CAAGxB,QAAQ,CAAC,KAAK,CAAC,CAErD,KAAM,CAAAyB,KAAK,CAAGP,MAAM,CAACQ,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAKb,OAAO,CAAC,CAChD,KAAM,CAAAc,UAAU,CAAGd,OAAO,CAAGI,iBAAiB,CAACJ,OAAO,CAAC,CAAG,EAAE,CAC5D,KAAM,CAAAe,SAAS,CAAGL,KAAK,CAAIR,QAAQ,GAAK,IAAI,CAAGQ,KAAK,CAACM,MAAM,CAAGN,KAAK,CAACO,IAAI,CAAI,EAAE,CAE9E,KAAM,CAAAC,YAAY,CAAIC,KAAa,EAAK,CACtC,GAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAE,CAChBX,cAAc,CAAC,IAAI,CAAC,CACpB;AACA,KAAM,CAAAY,OAAO,CAAGP,UAAU,CAACQ,MAAM,CAACC,MAAM,EACtCA,MAAM,CAACN,IAAI,CAACO,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACN,KAAK,CAACK,WAAW,CAAC,CAAC,CAAC,EACvDD,MAAM,CAACG,WAAW,CAACD,QAAQ,CAACN,KAAK,CAAC,EAClCI,MAAM,CAACI,aAAa,CAACH,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACN,KAAK,CAACK,WAAW,CAAC,CAAC,CACjE,CAAC,CACDjB,kBAAkB,CAACc,OAAO,CAAC,CAC7B,CAAC,IAAM,CACLZ,cAAc,CAAC,KAAK,CAAC,CACrBF,kBAAkB,CAAC,EAAE,CAAC,CACxB,CACF,CAAC,CAED,GAAI,CAACG,KAAK,CAAE,CACV,mBACEd,IAAA,QAAKgC,SAAS,CAAC,YAAY,CAAAC,QAAA,cACzBjC,IAAA,QAAKgC,SAAS,CAAC,WAAW,CAAAC,QAAA,cACxB/B,KAAA,QAAK8B,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BjC,IAAA,OAAAiC,QAAA,CAAI,iBAAe,CAAI,CAAC,cACxB/B,KAAA,CAACX,IAAI,EAAC2C,EAAE,CAAC,GAAG,CAACF,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eACtCjC,IAAA,CAACR,SAAS,EAAC2C,IAAI,CAAE,EAAG,CAAE,CAAC,UAEzB,EAAM,CAAC,EACJ,CAAC,CACH,CAAC,CACH,CAAC,CAEV,CAEA,KAAM,CAAAC,aAAa,CAAGxB,WAAW,CAAGF,eAAe,CAAGQ,UAAU,CAChE,KAAM,CAAAmB,gBAAgB,CAAGD,aAAa,CAACV,MAAM,CAACY,CAAC,EAAIA,CAAC,CAACC,WAAW,CAAC,CACjE,KAAM,CAAAC,cAAc,CAAGJ,aAAa,CAACV,MAAM,CAACY,CAAC,EAAI,CAACA,CAAC,CAACC,WAAW,CAAC,CAEhE,mBACErC,KAAA,QAAK8B,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBjC,IAAA,WAAQgC,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC9B/B,KAAA,QAAK8B,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBjC,IAAA,CAACT,IAAI,EAAC2C,EAAE,CAAC,GAAG,CAACF,SAAS,CAAC,UAAU,CAAAC,QAAA,cAC/BjC,IAAA,CAACR,SAAS,EAAC2C,IAAI,CAAE,EAAG,CAAE,CAAC,CACnB,CAAC,cAEPjC,KAAA,QAAK8B,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BjC,IAAA,QAAKgC,SAAS,CAAC,YAAY,CAAAC,QAAA,cACzBjC,IAAA,CAACP,MAAM,EAAC0C,IAAI,CAAE,EAAG,CAAE,CAAC,CACjB,CAAC,cACNjC,KAAA,QAAA+B,QAAA,eACEjC,IAAA,OAAAiC,QAAA,CAAKd,SAAS,CAAK,CAAC,cACpBjB,KAAA,QAAK8B,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BjC,IAAA,CAACN,KAAK,EAACyC,IAAI,CAAE,EAAG,CAAE,CAAC,cACnBjC,KAAA,SAAA+B,QAAA,EAAOf,UAAU,CAACuB,MAAM,CAAC,GAAC,CAACpC,CAAC,CAAC,cAAc,CAAC,EAAO,CAAC,EACjD,CAAC,EACH,CAAC,EACH,CAAC,EACH,CAAC,CACA,CAAC,cAETL,IAAA,SAAMgC,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC5B/B,KAAA,QAAK8B,SAAS,CAAC,WAAW,CAAAC,QAAA,eAExBjC,IAAA,CAACF,SAAS,EACR4C,QAAQ,CAAEpB,YAAa,CACvBqB,WAAW,sBAAAC,MAAA,CAAuBzB,SAAS,OAAM,CAClD,CAAC,CAGDkB,gBAAgB,CAACI,MAAM,CAAG,CAAC,eAC1BvC,KAAA,YAAS8B,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eAC5C/B,KAAA,OAAI8B,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACrCjC,IAAA,SAAMgC,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAE5B,CAAC,CAAC,WAAW,CAAC,CAAO,CAAC,oBAE3D,EAAI,CAAC,cACLL,IAAA,QAAKgC,SAAS,CAAC,cAAc,CAAAC,QAAA,CAC1BI,gBAAgB,CAACQ,GAAG,CAAElB,MAAM,eAC3B3B,IAAA,CAACH,UAAU,EAAiB8B,MAAM,CAAEA,MAAO,CAACb,KAAK,CAAEA,KAAM,EAAxCa,MAAM,CAACV,EAAmC,CAC5D,CAAC,CACC,CAAC,EACC,CACV,CAGAuB,cAAc,CAACC,MAAM,CAAG,CAAC,eACxBvC,KAAA,YAAS8B,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eAC1C/B,KAAA,OAAI8B,SAAS,CAAC,eAAe,CAAAC,QAAA,EAAC,mBAE5B,CAACI,gBAAgB,CAACI,MAAM,CAAG,CAAC,OAAAG,MAAA,CAASJ,cAAc,CAACC,MAAM,KAAG,EAC3D,CAAC,cACLzC,IAAA,QAAKgC,SAAS,CAAC,cAAc,CAAAC,QAAA,CAC1BO,cAAc,CAACK,GAAG,CAAElB,MAAM,eACzB3B,IAAA,CAACH,UAAU,EAAiB8B,MAAM,CAAEA,MAAO,CAACb,KAAK,CAAEA,KAAM,EAAxCa,MAAM,CAACV,EAAmC,CAC5D,CAAC,CACC,CAAC,EACC,CACV,CAGAmB,aAAa,CAACK,MAAM,GAAK,CAAC,eACzBzC,IAAA,QAAKgC,SAAS,CAAC,YAAY,CAAAC,QAAA,CACxBrB,WAAW,cACVZ,IAAA,MAAAiC,QAAA,CAAI5B,CAAC,CAAC,gBAAgB,CAAC,CAAI,CAAC,cAE5BH,KAAA,QAAK8B,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BjC,IAAA,CAACN,KAAK,EAACyC,IAAI,CAAE,EAAG,CAAE,CAAC,cACnBjC,KAAA,OAAA+B,QAAA,EAAI,0BAAwB,CAACd,SAAS,EAAK,CAAC,cAC5CnB,IAAA,MAAAiC,QAAA,CAAG,+CAA6C,CAAG,CAAC,cACpD/B,KAAA,CAACX,IAAI,EAAC2C,EAAE,CAAC,GAAG,CAACF,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eACtCjC,IAAA,CAACR,SAAS,EAAC2C,IAAI,CAAE,EAAG,CAAE,CAAC,eAEzB,EAAM,CAAC,EACJ,CACN,CACE,CACN,EACE,CAAC,CACF,CAAC,EACJ,CAAC,CAEV,CAAC,CAED,cAAe,CAAAhC,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}